FROM ubuntu

ENV POC_PATH /poc

# 创建容器内部的poc文件夹
RUN mkdir -p $POC_PATH

WORKDIR $POC_PATH

# 换apt下载源
#RUN sed -i s@/archive.ubuntu.com/@/mirrors.aliyun.com/@g /etc/apt/sources.list
#RUN sed -i s@/security.ubuntu.com/@/mirrors.aliyun.com/@g /etc/apt/sources.list
#RUN su
#RUN apt-get update -y

COPY poc.js $POC_PATH/poc.js

# 安装nodejs环境
ADD node-v12.22.12-linux-x64.tar.gz $POC_PATH/

RUN ln -s /poc/node-v12.22.12-linux-x64/bin/node /usr/local/bin/

RUN ln -s /poc/node-v12.22.12-linux-x64/bin/npm /usr/local/bin/

# 安装存在错误的依赖
RUN npm install --save parse-url@7.0.0

# 安装与之效果对比的工具
RUN npm install --save url